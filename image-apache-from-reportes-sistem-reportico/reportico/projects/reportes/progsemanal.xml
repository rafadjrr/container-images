<?xml version="1.0"?><Report><ReportQuery><Format><ReportTitle>Programacion Semanal</ReportTitle><ReportDescription>&lt;filegenname&gt;progsemanal&lt;/filegenname&gt;</ReportDescription><PageSize>.DEFAULT</PageSize><PageOrientation>.DEFAULT</PageOrientation><TopMargin></TopMargin><BottomMargin></BottomMargin><RightMargin></RightMargin><LeftMargin></LeftMargin><AutoPaginate></AutoPaginate><PdfZoomFactor></PdfZoomFactor><HtmlZoomFactor></HtmlZoomFactor><PageTitleDisplay></PageTitleDisplay><PageLayout></PageLayout><pdfFont></pdfFont><pdfFontSize></pdfFontSize><PreExecuteCode>NONE</PreExecuteCode><formBetweenRows>solidline</formBetweenRows><gridDisplay>.DEFAULT</gridDisplay><gridSortable>.DEFAULT</gridSortable><gridSearchable>.DEFAULT</gridSearchable><gridPageable>.DEFAULT</gridPageable><gridPageSize>.DEFAULT</gridPageSize></Format><Datasource><SourceType>database</SourceType><SourceConnection><DatabaseType>mysql</DatabaseType><DatabaseName></DatabaseName><HostName></HostName><ServiceName></ServiceName><UserName></UserName><Password></Password></SourceConnection></Datasource><EntryForm><Query><TableSql></TableSql><WhereSql></WhereSql><GroupSql></GroupSql><RowSelection>all</RowSelection><SQL><QuerySql></QuerySql><SQLRaw>
select b.CodMovimiento,b.Referencia,b.FechaCompromiso,a.NombreClienteProveedor,c.CodArticulo,h.Descripcion,(CASE WHEN c.CantidadOrden&gt;0 THEN c.CantidadOrden ELSE c.Cantidad END) as Cantidad,c.UnidadMedida ,(CASE WHEN c.CantidadOrden&gt;0 THEN c.CantidadOrden/g.Factor ELSE c.Cantidad/g.Factor END) as Paletas from en01fact a join dt08fact b on a.CodMovimiento=a.CodMovimiento and a.Referencia=b.Referencia join dt05fact c ON a.CodMovimiento=c.CodMovimiento and a.Referencia=c.Referencia join dt05arti d ON c.CodArticulo=d.CodArticulo and c.UnidadMedida=d.Medida join (select e2.CodArticulo,f2.Factor from (select distinct c2.CodArticulo,(CASE WHEN d2.CodArticulo is null THEN '*default*' ELSE d2.CodArticulo END) as Codpaleta,(CASE WHEN d2.Medida is null THEN 'PALETAS' ELSE d2.Medida END) as Codmedida from dt08fact b2 join dt01fact c2 ON b2.CodMovimiento=c2.CodMovimiento and b2.Referencia=c2.Referencia left outer join dt09arti d2 ON c2.CodArticulo=d2.CodArticulo where b2.CodMovimiento='PED' [and b2.FechaCompromiso between DATEADD(WEEK, DATEDIFF(WEEK, 0, DATEADD(DAY, -2 +7*{semana},(select Fecha_Desde from mt01peco where Periodo={periodo}))), 0) and DATEADD(DAY, 6, DATEADD(WEEK, DATEDIFF(WEEK, 0, DATEADD(DAY, -2 +7*{semana},(select Fecha_Desde from mt01peco where Periodo={periodo}))), 0))]) e2 join dt09arti f2 on e2.Codpaleta=f2.CodArticulo and e2.Codmedida=f2.Medida) g ON c.CodArticulo=g.CodArticulo join en01arti h ON c.CodArticulo=h.CodArticulo where a.CodMovimiento='PED' [and b.FechaCompromiso between DATEADD(WEEK, DATEDIFF(WEEK, 0, DATEADD(DAY, -2 +7*{semana},(select Fecha_Desde from mt01peco where Periodo={periodo}))), 0) and DATEADD(DAY, 6, DATEADD(WEEK, DATEDIFF(WEEK, 0, DATEADD(DAY, -2 +7*{semana},(select Fecha_Desde from mt01peco where Periodo={periodo}))), 0))]  and d.Factor=1 order by b.FechaCompromiso,b.Referencia</SQLRaw></SQL><QueryColumns><QueryColumn><Name>CodMovimiento</Name><TableName>b</TableName><ColumnName>CodMovimiento</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>hide</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>left</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title>CODIGO</column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>Referencia</Name><TableName>b</TableName><ColumnName>Referencia</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>hide</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>left</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title>REF</column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>FechaCompromiso</Name><TableName>b</TableName><ColumnName>FechaCompromiso</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>hide</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>left</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML>80px</ColumnWidthHTML><column_title>FECHA</column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>NombreClienteProveedor</Name><TableName>a</TableName><ColumnName>NombreClienteProveedor</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>hide</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>left</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML>350px</ColumnWidthHTML><column_title> </column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>CodArticulo</Name><TableName>c</TableName><ColumnName>CodArticulo</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>left</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML>15%</ColumnWidthHTML><column_title>ARTICULO</column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>UnidadMedida</Name><TableName>c</TableName><ColumnName>UnidadMedida</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>right</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML>10%</ColumnWidthHTML><column_title>UNIDAD</column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>Cantidad</Name><TableName></TableName><ColumnName>(CASE WHEN c.CantidadOrden&gt;0 THEN c.CantidadOrden ELSE c.Cantidad END) as</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>right</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML>10%</ColumnWidthHTML><column_title>CANTIDAD</column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>DS</Name><TableName></TableName><ColumnName></ColumnName><ColumnType></ColumnType><ColumnLength></ColumnLength><Format><column_display>hide</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>left</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title></column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>Paletas</Name><TableName></TableName><ColumnName>(CASE WHEN c.CantidadOrden&gt;0 THEN c.CantidadOrden/g.Factor ELSE c.Cantidad/g.Factor END) as</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>right</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML>10%</ColumnWidthHTML><column_title>PALETAS</column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>DiaSemESP</Name><TableName></TableName><ColumnName></ColumnName><ColumnType></ColumnType><ColumnLength></ColumnLength><Format><column_display>hide</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>left</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML></ColumnWidthHTML><column_title></column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn><QueryColumn><Name>Descripcion</Name><TableName>h</TableName><ColumnName>Descripcion</ColumnName><ColumnType>char</ColumnType><ColumnLength>30</ColumnLength><Format><column_display>show</column_display><content_type>plain</content_type><ColumnStartPDF></ColumnStartPDF><justify>left</justify><ColumnWidthPDF></ColumnWidthPDF><ColumnWidthHTML>55%</ColumnWidthHTML><column_title>DESCRIPCION</column_title><tooltip></tooltip><group_header_label>0</group_header_label><group_header_label_xpos></group_header_label_xpos><group_header_data_xpos></group_header_data_xpos><group_trailer_label>0</group_trailer_label></Format></QueryColumn></QueryColumns><OrderColumns></OrderColumns><PreSQLS></PreSQLS></Query><Assignments><Assignment><AssignName>DS</AssignName><AssignNameNew></AssignNameNew><Expression>date(&quot;w&quot;, strtotime({FechaCompromiso}))</Expression><Condition></Condition></Assignment><Assignment><AssignName>DiaSemESP</AssignName><AssignNameNew></AssignNameNew><Expression>({DS}==1?'Lunes':({DS}==2?'Martes':({DS}==3?'Miercoles':({DS}==4?'Jueves':({DS}==5?'Viernes':({DS}==6?'Sabado':'Domingo'))))))</Expression><Condition></Condition></Assignment><Assignment><AssignName>Paletas</AssignName><AssignNameNew></AssignNameNew><Expression>number_format({Paletas},2,',','.')</Expression><Condition></Condition></Assignment><Assignment><AssignName>Cantidad</AssignName><AssignNameNew></AssignNameNew><Expression>number_format({Cantidad},2,',','.')</Expression><Condition></Condition></Assignment><Assignment><AssignName>FechaCompromiso</AssignName><AssignNameNew></AssignNameNew><Expression>date(&quot;d/m/Y&quot;, strtotime({FechaCompromiso}))</Expression><Condition></Condition></Assignment><Assignment><AssignName>NombreClienteProveedor</AssignName><AssignNameNew></AssignNameNew><Expression>'&lt;b&gt;-PED '.{Referencia}.'-&lt;/b&gt; '.{DiaSemESP}.' '.{FechaCompromiso}.' '.{NombreClienteProveedor}</Expression><Condition></Condition></Assignment></Assignments><Criteria><CriteriaItem><Name>periodo</Name><Title>Periodo</Title><QueryTableName></QueryTableName><QueryColumnName></QueryColumnName><CriteriaType>TEXTFIELD</CriteriaType><CriteriaHelp></CriteriaHelp><CriteriaDisplay>NOINPUT</CriteriaDisplay><ExpandDisplay>NOINPUT</ExpandDisplay><CriteriaRequired></CriteriaRequired><CriteriaHidden></CriteriaHidden><CriteriaDisplayGroup></CriteriaDisplayGroup><ReturnColumn></ReturnColumn><DisplayColumn></DisplayColumn><OverviewColumn></OverviewColumn><MatchColumn></MatchColumn><CriteriaDefaults>01</CriteriaDefaults><CriteriaList>&lt;Attrib&gt;setAttrib[maxlength=2,class=span1];addFilter[StringTrim,HtmlEntities]&lt;/Attrib&gt;</CriteriaList><Query><TableSql></TableSql><WhereSql></WhereSql><GroupSql></GroupSql><RowSelection></RowSelection><SQLRaw></SQLRaw><SQL><QuerySql></QuerySql></SQL><QueryColumns></QueryColumns><OrderColumns></OrderColumns><Assignments></Assignments></Query><CriteriaLinks></CriteriaLinks></CriteriaItem><CriteriaItem><Name>semana</Name><Title>Semana</Title><QueryTableName></QueryTableName><QueryColumnName></QueryColumnName><CriteriaType>TEXTFIELD</CriteriaType><CriteriaHelp></CriteriaHelp><CriteriaDisplay>NOINPUT</CriteriaDisplay><ExpandDisplay>NOINPUT</ExpandDisplay><CriteriaRequired></CriteriaRequired><CriteriaHidden></CriteriaHidden><CriteriaDisplayGroup></CriteriaDisplayGroup><ReturnColumn></ReturnColumn><DisplayColumn></DisplayColumn><OverviewColumn></OverviewColumn><MatchColumn></MatchColumn><CriteriaDefaults>1</CriteriaDefaults><CriteriaList>&lt;Attrib&gt;setAttrib[maxlength=2,class=span1];addFilter[StringTrim,HtmlEntities]&lt;/Attrib&gt;</CriteriaList><Query><TableSql></TableSql><WhereSql></WhereSql><GroupSql></GroupSql><RowSelection></RowSelection><SQLRaw></SQLRaw><SQL><QuerySql></QuerySql></SQL><QueryColumns></QueryColumns><OrderColumns></OrderColumns><Assignments></Assignments></Query><CriteriaLinks></CriteriaLinks></CriteriaItem></Criteria><Output><PageHeaders></PageHeaders><PageFooters></PageFooters><DisplayOrders><DisplayOrder><ColumnName>CodMovimiento</ColumnName><OrderNumber>1</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>Referencia</ColumnName><OrderNumber>2</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>FechaCompromiso</ColumnName><OrderNumber>3</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>NombreClienteProveedor</ColumnName><OrderNumber>4</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>CodArticulo</ColumnName><OrderNumber>5</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>Descripcion</ColumnName><OrderNumber>6</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>Cantidad</ColumnName><OrderNumber>7</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>UnidadMedida</ColumnName><OrderNumber>8</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>Paletas</ColumnName><OrderNumber>9</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>DS</ColumnName><OrderNumber>10</OrderNumber></DisplayOrder><DisplayOrder><ColumnName>DiaSemESP</ColumnName><OrderNumber>11</OrderNumber></DisplayOrder></DisplayOrders><Groups><Group><GroupName>Referencia</GroupName><BeforeGroupHeader>blankline</BeforeGroupHeader><AfterGroupHeader>blankline</AfterGroupHeader><BeforeGroupTrailer>blankline</BeforeGroupTrailer><AfterGroupTrailer>blankline</AfterGroupTrailer><GroupHeaders><GroupHeader><GroupHeaderColumn>NombreClienteProveedor</GroupHeaderColumn><GroupHeaderCustom></GroupHeaderCustom><ShowInHTML>yes</ShowInHTML><ShowInPDF>yes</ShowInPDF></GroupHeader></GroupHeaders><GroupTrailers></GroupTrailers></Group></Groups><Graphs></Graphs></Output></EntryForm></ReportQuery></Report>